FROM ros:jazzy

# Install LGDXRobot2 ROS2
RUN apt update \
  && apt install -y --no-install-recommends \
    wget unzip dpkg \
  && wget https://gitlab.com/api/v4/projects/53439376/packages/generic/LGDXRobot2-ROS2/latest/lgdxrobot2-ros2-arm64.zip -O lgdxrobot2-ros2.zip \
  && unzip lgdxrobot2-ros2.zip \
  && cd debs \
  && apt install -y --no-install-recommends ./*.deb \
  && dpkg -i *.deb \
  && cd .. \
  && rm lgdxrobot2-ros2.zip \
  && rm -rf debs \
  && rm -rf /var/lib/apt/lists/*

# Install sllidar_ros2
RUN wget https://gitlab.com/api/v4/projects/53439376/packages/generic/sllidar_ros2/latest/sllidar_ros2-arm64.zip -O sllidar_ros2.zip \
  && unzip sllidar_ros2.zip \
  && cd debs \
  && apt install -y --no-install-recommends ./*.deb \
  && dpkg -i *.deb \
  && cd .. \
  && rm sllidar_ros2.zip \
  && rm -rf debs

COPY Docker/root/ros_entrypoint.sh /
RUN chmod +x /ros_entrypoint.sh

ENTRYPOINT ["/ros_entrypoint.sh"]
CMD ["bash"]